// ZxDrawer 抽屉组件样式
// 纯净组件样式，充分利用 Element Plus 的品牌色 CSS3 变量

// 导入变量定义
@import './var.scss';

// 抽屉容器样式
.zx-drawer {
  // Element Plus 抽屉基础样式覆盖
  .el-drawer {
    // 确保抽屉不会超出视窗
    max-width: 100vw;
    max-height: 100vh;
  }

  // 头部样式
  .el-drawer__header {
    background-color: var(--cmp-drawer-header-bg);
    border-bottom: 1px solid var(--cmp-drawer-header-border);
    padding: var(--cmp-drawer-header-padding);
    margin-bottom: 0;

    // 头部标题样式
    .el-drawer__title {
      color: var(--cmp-drawer-text-color);
      font-size: var(--cmp-drawer-title-font-size);
      font-weight: var(--cmp-drawer-title-font-weight);
    }
  }

  // 内容区域样式
  .el-drawer__body {
    background-color: var(--cmp-drawer-body-bg);
    color: var(--cmp-drawer-text-color);
    padding: 0;
    // overflow: hidden;
  }

  // 底部操作栏样式
  .el-drawer__footer {
    background-color: var(--cmp-drawer-footer-bg);
    border-top: 1px solid var(--cmp-drawer-footer-border);
    padding: var(--cmp-drawer-footer-padding);

    // 按钮组样式
    .el-button + .el-button {
      margin-left: 12px;
    }
  }

  // 关闭按钮样式
  .el-drawer__close-btn {
    color: var(--cmp-drawer-text-secondary);
    font-size: 16px;
    padding: 0 15px;

    &:hover {
      color: var(--cmp-drawer-hover-color);
    }
  }
}

// 抽屉主体内容样式
.zx-drawer-body {
  // height: 100%;
  width: 100%;
  overflow: hidden;
  padding: var(--cmp-drawer-body-padding);

  // 最小尺寸限制
  min-width: var(--cmp-drawer-body-min-width);
  min-height: var(--cmp-drawer-body-min-height);

  // 滚动条样式
  &::-webkit-scrollbar {
    width: var(--cmp-drawer-scrollbar-width);
    height: var(--cmp-drawer-scrollbar-width);
  }

  &::-webkit-scrollbar-track {
    background: var(--cmp-drawer-scrollbar-track);
    border-radius: 3px;
  }

  &::-webkit-scrollbar-thumb {
    background: var(--cmp-drawer-scrollbar-thumb);
    border-radius: 3px;

    &:hover {
      background: var(--cmp-drawer-scrollbar-thumb-hover);
    }
  }
}

// 当存在拖拽手柄时，给主体内容增加左内边距
.zx-drawer:has(.zx-drawer-handle) .zx-drawer-body {
  padding-left: calc(var(--cmp-drawer-body-padding) + 15px);
}

// 当存在拖拽手柄时，给头部增加左内边距
.zx-drawer:has(.zx-drawer-handle) .el-drawer__header {
  padding-left: calc(var(--cmp-drawer-header-padding) + 15px);
}

.zx-drawer-header-draggable {
  cursor: move;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;

  .zx-drawer-right-operation,
  .zx-drawer-right-operation *,
  button,
  a {
    cursor: pointer;
  }

  [data-drag-exclude] {
    cursor: auto;
  }
}

// 无标题样式
.zx-drawer-no-title {
  .el-drawer__header {
    display: none;
  }

  .zx-drawer-body {
    padding-top: 20px;
  }
}

// 无遮罩样式
.zx-drawer-no-mask {
  .el-overlay {
    background-color: transparent;
  }

  .el-drawer {
    box-shadow: var(--cmp-drawer-shadow);
  }
}

// 无内容边距样式
.zx-drawer-no-content-padding {
  .zx-drawer-body {
    padding: 0;
  }
}

// 拖拽手柄样式
.zx-drawer-handle {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: var(--cmp-drawer-handle-width);
  background-color: var(--cmp-drawer-handle-bg);
  cursor: col-resize;
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;

  // 当需要显示边框时
  &.zx-drawer-handle-with-border {
    border-right: 1px solid var(--cmp-drawer-handle-border);
  }

  // 悬停效果
  &:hover {
    background-color: var(--cmp-drawer-handle-hover-bg);
    width: var(--cmp-drawer-handle-width-hover);
  }

  // 激活状态
  &:active {
    background-color: var(--cmp-drawer-handle-active-bg);
  }
}

// 拖拽手柄点状图标
.zx-drawer-handle-dots {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(5, 1fr);
  gap: 2px;
  width: 16px;
  height: 24px;
  padding: 0 4px;
  place-items: center;
  pointer-events: none;

  .zx-dot {
    width: 3px;
    height: 3px;
    background-color: var(--cmp-drawer-dots-color);
    border-radius: 50%;
    transition: all 0.2s ease;
    opacity: 0.9;
    box-shadow: 0 0 1px rgba(0, 0, 0, 0.1);
  }

  .zx-drawer-handle:hover & .zx-dot {
    background-color: var(--cmp-drawer-dots-hover-color);
    opacity: 1;
  }

  .zx-drawer-handle:active & .zx-dot {
    background-color: var(--cmp-drawer-dots-active-color);
    opacity: 1;
  }
}

// 右侧操作区域
.zx-drawer-right-operation {
  display: flex;
  align-items: center;
  gap: var(--cmp-drawer-operation-gap);
  margin-left: var(--cmp-drawer-operation-margin);
  flex-shrink: 0;

  // 操作项通用样式
  > * {
    cursor: pointer;
    color: var(--cmp-drawer-icon-color);
    font-size: 14px; // 与全屏按钮保持一致
    transition: color 0.2s ease;
    display: flex;
    align-items: center;
    min-height: 28px; // 与全屏按钮保持一致

    &:hover {
      color: var(--cmp-drawer-icon-hover-color);
    }
  }

  // ZxIcon 样式
  .zx-drawer-fullscreen-icon {
    cursor: pointer;
    color: var(--cmp-drawer-icon-color);
    font-size: var(--cmp-drawer-icon-size);
    transition: all 0.3s ease;

    &:hover {
      color: var(--cmp-drawer-icon-hover-color);
      transform: scale(1.1);
    }

    &:active {
      transform: scale(0.95);
    }
  }
}

// 替换 Tailwind CSS 的通用布局类
.zx-drawer-header-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
}

.zx-drawer-title-container {
  display: flex;
  flex: 1;
  align-items: center;
  justify-content: space-between;
  overflow: hidden;
}

.zx-drawer-title-content {
  display: flex;
  flex: 1;
  align-items: center;
  overflow: hidden;
}

.zx-drawer-footer-container {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.zx-drawer-footer-actions {
  margin-left: auto;
  display: flex;
  gap: 12px;
}

// 文本截断和尺寸限制
.zx-drawer-title-text {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 300px;
}

.zx-drawer-title-tag {
  margin-left: 8px;
  margin-right: auto;
}

// 全屏按钮样式
.zx-drawer-fullscreen-btn {
  border-radius: 4px;
  transition: all 0.2s ease;
  padding: 6px 0 6px 10px;
  height: auto;
  min-height: 28px;
  color: var(--cmp-drawer-text-color);
  font-size: 14px;
  line-height: 1.4;
  display: flex;
  align-items: center;
  justify-content: center;

  // 按钮内图标和文字的间距
  .zx-icon {
    margin-right: 6px;
    font-size: 14px;
    display: flex;
    align-items: center;
  }

  &:hover {
    color: var(--cmp-drawer-hover-color);
  }

  &:focus {
    color: var(--cmp-drawer-hover-color);
  }
}

// 描述列表样式增强
.zx-drawer-body {
  .el-descriptions {
    .el-descriptions__header {
      margin-bottom: 16px;

      .el-descriptions__title {
        font-size: var(--cmp-drawer-desc-title-size);
        font-weight: var(--cmp-drawer-desc-title-weight);
        color: var(--cmp-drawer-desc-title-color);
      }
    }

    .el-descriptions__body {
      .el-descriptions__table {
        .el-descriptions__cell {
          padding: var(--cmp-drawer-desc-cell-padding);
          border-bottom: 1px solid var(--cmp-drawer-desc-border);

          &.is-bordered-label {
            background-color: var(--cmp-drawer-desc-label-bg);
            font-weight: 500;
            color: var(--cmp-drawer-desc-label-color);
          }

          &.is-bordered-content {
            color: var(--cmp-drawer-desc-content-color);
          }
        }
      }
    }
  }
}

// 响应式设计
@media (max-width: 768px) {
  .zx-drawer {
    .el-drawer {
      width: 100% !important;
    }
  }

  .zx-drawer-body {
    min-width: var(--cmp-drawer-mobile-min-width);
    padding: var(--cmp-drawer-mobile-padding);
  }

  .zx-drawer-header {
    padding: var(--cmp-drawer-mobile-padding);

    .zx-drawer-title {
      font-size: var(--cmp-drawer-mobile-title-size);
    }
  }

  .zx-drawer-footer {
    padding: var(--cmp-drawer-mobile-padding);
  }

  .zx-drawer-handle {
    display: none;
  }

  .zx-drawer-right-operation {
    gap: 4px;

    .el-button {
      padding: 7px 15px;
      font-size: 12px;
    }
  }
}

// 平板适配
@media (max-width: 1024px) and (min-width: 769px) {
  .zx-drawer-body {
    min-width: 400px;
    padding: 18px;
  }
}

// 动画增强
.zx-drawer {
  .el-drawer {
    transition: all var(--cmp-drawer-transition-duration) var(--cmp-drawer-transition-timing);
  }

  .zx-drawer-header,
  .zx-drawer-body,
  .zx-drawer-footer {
    transition: all var(--cmp-drawer-content-transition);
  }

  // 进入动画
  &.el-drawer__open {
    .zx-drawer-body {
      animation: zx-drawer-content-fade-in 0.3s ease-out;
    }
  }
}

// 内容淡入动画
@keyframes zx-drawer-content-fade-in {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

// 加载状态样式
.zx-drawer-loading {
  .zx-drawer-body {
    position: relative;

    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--cmp-drawer-loading-bg);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
}

.zx-drawer-body {
  .el-loading-mask {
    background-color: rgba(255, 255, 255, 0.8);

    .el-loading-spinner {
      .el-loading-text {
        color: #303133;
      }
    }
  }
}
